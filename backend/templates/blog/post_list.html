{% extends "base.html" %}
{% load static %}
{% block title %}{% if meta_title %}{{ meta_title }}{% else %}Latest Posts - {{ site_meta.site_name }}{% endif %}{% endblock %}
{% block meta_description %}{{ meta_description|default:"Discover the latest AI-assisted blogging tutorials, strategy guides, and news from BlogCraftAI." }}{% endblock %}
{% block content %}
<section class="hero">
    <div class="card">
        <h1>Latest posts</h1>
        <p>Stay ahead with AI-assisted storytelling, editorial best practices, and growth experiments.</p>
        <form class="search-form" role="search">
            <label for="search" class="visually-hidden">Search articles</label>
            <input id="search" name="q" placeholder="Search posts" value="{{ search_term }}" />
            <button class="button" type="submit">Search</button>
        </form>
    </div>
</section>

<section class="filters" aria-label="Post filters">
    <ul class="tag-cloud">
        <li><a href="{% url 'blog:post-list' %}" class="{% if not active_tag %}active{% endif %}">All</a></li>
        {% for tag in tags %}
            <li><a href="?tag={{ tag.slug }}" class="{% if active_tag == tag.slug %}active{% endif %}">{{ tag.name }}</a></li>
        {% endfor %}
    </ul>
</section>

<section class="grid" aria-label="Post listings">
    {% for post in posts %}
        <article class="card" aria-labelledby="post-{{ post.slug }}">
            <header>
                <h2 id="post-{{ post.slug }}"><a href="{{ post.get_absolute_url }}">{{ post.title }}</a></h2>
                <p class="meta">By {{ post.author.safe_display_name }} - {{ post.published_at|date:"F j, Y" }}</p>
            </header>
            <p>{{ post.summary|truncatewords:40 }}</p>
            <footer>
                <a class="button secondary" href="{{ post.get_absolute_url }}" aria-label="Read {{ post.title }}">Read more</a>
            </footer>
        </article>
    {% empty %}
        <p>No posts yet. Check back soon for fresh content.</p>
    {% endfor %}
</section>

{% if is_paginated %}
    <nav class="pagination" aria-label="Pagination">
        {% if page_obj.has_previous %}
            <a class="button secondary" href="?page={{ page_obj.previous_page_number }}{% if search_term %}&amp;q={{ search_term }}{% endif %}{% if active_tag %}&amp;tag={{ active_tag }}{% endif %}">Previous</a>
        {% endif %}
        <span>Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span>
        {% if page_obj.has_next %}
            <a class="button secondary" href="?page={{ page_obj.next_page_number }}{% if search_term %}&amp;q={{ search_term }}{% endif %}{% if active_tag %}&amp;tag={{ active_tag }}{% endif %}">Next</a>
        {% endif %}
    </nav>
{% endif %}
{% endblock %}
